[req]
distinguished_name = req_distinguished_name
prompt             = no
x509_extensions    = ca_x509_extensions

[ca_x509_extensions]
basicConstraints = CA:TRUE
keyUsage         = cRLSign, keyCertSign

[req_distinguished_name]
C   = US
ST  = San Jose
L   = Heredia
CN  = CA

[admin]
distinguished_name = admin_distinguished_name
prompt             = no
req_extensions     = default_req_extensions

[admin_distinguished_name]
CN = admin
O  = system:masters

[service-accounts]
distinguished_name = service-accounts_distinguished_name
prompt             = no
req_extensions     = default_req_extensions

[service-accounts_distinguished_name]
CN = service-accounts

[worker1]
distinguished_name = worker1_dn
prompt             = no
req_extensions     = worker1_req_extensions

[worker1_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Worker 1 Certificate"
subjectAltName       = DNS:worker1.k8s.local, DNS:worker1, IP:192.168.100.132
subjectKeyIdentifier = hash

[worker1_dn]
CN = system:node:worker1
O  = system:nodes
C  = US
ST = San Jose
L  = Heredia

[worker2]
distinguished_name = worker2_dn
prompt             = no
req_extensions     = worker2_req_extensions

[worker2_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Worker 2 Certificate"
subjectAltName       = DNS:worker2.k8s.local, DNS:worker2, IP:192.168.100.133
subjectKeyIdentifier = hash

[worker2_dn]
CN = system:node:worker2
O  = system:nodes
C  = US
ST = San Jose
L  = Heredia

[worker3]
distinguished_name = worker3_dn
prompt             = no
req_extensions     = worker3_req_extensions

[worker3_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Worker 3 Certificate"
subjectAltName       = DNS:worker3.k8s.local, DNS:worker3, IP:192.168.100.134
subjectKeyIdentifier = hash

[worker3_dn]
CN = system:node:worker3
O  = system:nodes
C  = US
ST = San Jose
L  = Heredia

[kube-proxy]
distinguished_name = kube-proxy_distinguished_name
prompt             = no
req_extensions     = kube-proxy_req_extensions

[kube-proxy_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Kube Proxy Certificate"
subjectAltName       = DNS:kube-proxy, IP:127.0.0.1
subjectKeyIdentifier = hash

[kube-proxy_distinguished_name]
CN = system:kube-proxy
O  = system:node-proxier
C  = US
ST = San Jose
L  = Heredia

[kube-controller-manager]
distinguished_name = kube-controller-manager_distinguished_name
prompt             = no
req_extensions     = kube-controller-manager_req_extensions

[kube-controller-manager_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Kube Controller Manager Certificate"
subjectAltName       = DNS:kube-controller-manager, IP:127.0.0.1
subjectKeyIdentifier = hash

[kube-controller-manager_distinguished_name]
CN = system:kube-controller-manager
O  = system:kube-controller-manager
C  = US
ST = San Jose
L  = Heredia

[kube-scheduler]
distinguished_name = kube-scheduler_distinguished_name
prompt             = no
req_extensions     = kube-scheduler_req_extensions

[kube-scheduler_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Kube Scheduler Certificate"
subjectAltName       = DNS:kube-scheduler, IP:127.0.0.1
subjectKeyIdentifier = hash

[kube-scheduler_distinguished_name]
CN = system:kube-scheduler
O  = system:system:kube-scheduler
C  = US
ST = San Jose
L  = Heredia

[kube-api-server]
distinguished_name = kube-api-server_distinguished_name
prompt             = no
req_extensions     = kube-api-server_req_extensions

[kube-api-server_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client, server
nsComment            = "Kube API Server Certificate"
subjectAltName       = @kube-api-server_alt_names
subjectKeyIdentifier = hash

[kube-api-server_alt_names]
IP.0  = 127.0.0.1
IP.1  = 10.0.0.1
IP.2  = 192.168.100.149
IP.3  = 192.168.100.150
IP.4  = 192.168.100.151
IP.5  = 192.168.100.100
DNS.0 = kubernetes
DNS.1 = kubernetes.default
DNS.2 = kubernetes.default.svc
DNS.3 = kubernetes.default.svc.cluster
DNS.4 = kubernetes.default.svc.cluster.local
DNS.5 = master1.k8s.local
DNS.6 = master2.k8s.local
DNS.7 = master3.k8s.local

[kube-api-server_distinguished_name]
CN = kubernetes
C  = US
ST = San Jose
L  = Heredia

[default_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Admin Client Certificate"
subjectKeyIdentifier = hash

[etcd-master1]
distinguished_name = etcd-master1_dn
prompt             = no
req_extensions     = etcd-master1_req_extensions

[etcd-master1_dn]
CN = master1
O  = etcd
C  = US
ST = San Jose
L  = Heredia

[etcd-master1_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
subjectAltName       = @etcd-master1_alt_names
subjectKeyIdentifier = hash

[etcd-master1_alt_names]
DNS.1 = master1
DNS.2 = master1.k8s.local
IP.1  = 192.168.100.149
IP.2  = 127.0.0.1
IP.3  = 192.168.100.100

[etcd-master2]
distinguished_name = etcd-master2_dn
prompt             = no
req_extensions     = etcd-master2_req_extensions

[etcd-master2_dn]
CN = master2
O  = etcd
C  = US
ST = San Jose
L  = Heredia

[etcd-master2_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
subjectAltName       = @etcd-master2_alt_names
subjectKeyIdentifier = hash

[etcd-master2_alt_names]
DNS.1 = master2
DNS.2 = master2.k8s.local
IP.1  = 192.168.100.150
IP.2  = 127.0.0.1
IP.3  = 192.168.100.100

[etcd-master3]
distinguished_name = etcd-master3_dn
prompt             = no
req_extensions     = etcd-master3_req_extensions

[etcd-master3_dn]
CN = master3
O  = etcd
C  = US
ST = San Jose
L  = Heredia

[etcd-master3_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
subjectAltName       = @etcd-master3_alt_names
subjectKeyIdentifier = hash

[etcd-master3_alt_names]
DNS.1 = master3
DNS.2 = master3.k8s.local
IP.1  = 192.168.100.151
IP.2  = 127.0.0.1
IP.3  = 192.168.100.100

